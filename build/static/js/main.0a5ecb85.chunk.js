(this.webpackJsonptodo=this.webpackJsonptodo||[]).push([[0],{100:function(e,t,a){"use strict";a.r(t);var c=a(0),r=a.n(c),s=a(22),n=a.n(s),o=a(6),d=a(2),i=a(56);function j(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function u(e,t){return"FETCH_USERS"===t.type?(console.log(t.users),t.users):e}function l(e,t){switch(t.type){case"CREATE_TODO":var a={title:t.title,description:t.description,dateCreated:t.dateCreated,completed:t.completed,dateCompleted:t.dateCompleted,_id:t._id,author:t.author};return console.log(a.id),[a].concat(Object(i.a)(e));case"TOGGLE_TODO":return e.map((function(e){return e._id===t.id&&e.completed?Object(d.a)(Object(d.a)({},e),{},{completed:!1,dateCompleted:""}):e._id!==t.id||e.completed?e:Object(d.a)(Object(d.a)({},e),{},{completed:!0,dateCompleted:Date(Date.now()).toString()})}));case"DELETE_TODO":return e.filter((function(e){return e._id!==t.id}));case"FETCH_TODOS":return console.log(t.todos),t.todos;default:return e}}function b(e,t){return{user:j(e.user,t),users:u(e.users,t),todos:l(e.todos,t)}}var O=a(9),h=a(11),p=a(10),x=a(108),m=a(106),f=a(103),g=a(1);function v(e){var t=e.show,a=e.handleClose,r=Object(p.d)(),s=Object(c.useContext)(O.a).dispatch,n=Object(c.useState)(""),d=Object(o.a)(n,2),i=d[0],j=d[1],u=Object(c.useState)(!1),l=Object(o.a)(u,2),b=l[0],v=l[1],C=Object(c.useState)(""),w=Object(o.a)(C,2),y=w[0],E=w[1];var T=Object(h.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),k=Object(o.a)(T,2),_=k[0],S=k[1];return Object(c.useEffect)((function(){_&&!1===_.isLoading&&(_.data||_.error)&&(_.error?(v(!0),alert("Login failed, please try again")):(v(!1),console.log(_.data),s({type:"LOGIN",username:i,access_token:_.data.access_token}),r.navigate("/users/".concat(i))))}),[_]),Object(g.jsx)(x.a,{show:t,onHide:a,children:Object(g.jsxs)(m.a,{onSubmit:function(e){e.preventDefault(),S(i,y),a()},children:[Object(g.jsx)(x.a.Header,{closeButton:!0,children:Object(g.jsx)(x.a.Title,{children:"Login"})}),Object(g.jsxs)(x.a.Body,{children:[Object(g.jsx)(m.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(g.jsx)(m.a.Control,{type:"text",value:i,onChange:function(e){j(e.target.value)},name:"login-username",id:"login-username"}),Object(g.jsx)(m.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(g.jsx)(m.a.Control,{type:"password",value:y,onChange:function(e){E(e.target.value)},name:"login-password",id:"login-password"}),b&&Object(g.jsx)(m.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(g.jsxs)(x.a.Footer,{children:[Object(g.jsx)(f.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(g.jsx)(f.a,{variant:"primary",disabled:0===i.length,type:"submit",children:"Login"})]})]})})}function C(e){var t=e.show,a=e.handleClose,r=Object(p.d)(),s=Object(c.useContext)(O.a).dispatch,n=Object(c.useState)({username:"",password:"",passwordRepeat:""}),i=Object(o.a)(n,2),j=i[0],u=i[1],l=Object(c.useState)(""),b=Object(o.a)(l,2),v=(b[0],b[1]),C=Object(h.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),w=Object(o.a)(C,2),y=w[0],E=w[1];return Object(c.useEffect)((function(){y&&y.data&&(s({type:"REGISTER",username:y.data.username,access_token:y.data.access_token}),r.navigate("/users/".concat(y.data.username)))}),[y]),Object(c.useEffect)((function(){y&&!1===y.isLoading&&(y.data||y.error)&&(y.error?(console.log(y),v("Registration failed, please try again later."),alert("fail")):(console.log(y),v("Registration successful. You may now login."),alert("You have registered successfully, now routing to your profile page...")))}),[y]),Object(g.jsx)(x.a,{show:t,onHide:a,children:Object(g.jsxs)(m.a,{onSubmit:function(e){e.preventDefault(),E(j.username,j.password),a()},children:[Object(g.jsx)(x.a.Header,{closeButton:!0,children:Object(g.jsx)(x.a.Title,{children:"Register"})}),Object(g.jsxs)(x.a.Body,{children:[Object(g.jsx)(m.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(g.jsx)(m.a.Control,{type:"text",value:j.username,onChange:function(e){return u(Object(d.a)(Object(d.a)({},j),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(g.jsx)(m.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(g.jsx)(m.a.Control,{type:"password",name:"register-password",id:"register-password",value:j.password,onChange:function(e){return u(Object(d.a)(Object(d.a)({},j),{},{password:e.target.value}))}}),Object(g.jsx)(m.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(g.jsx)(m.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:j.passwordRepeat,onChange:function(e){return u(Object(d.a)(Object(d.a)({},j),{},{passwordRepeat:e.target.value}))}})]}),Object(g.jsxs)(x.a.Footer,{children:[Object(g.jsx)(f.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(g.jsx)(f.a,{variant:"primary",type:"submit",disabled:0===j.username.length||0===j.password.length||j.password!==j.passwordRepeat,children:"Register"})]})]})})}function w(){var e=r.a.lazy((function(){return a.e(3).then(a.bind(null,110))})),t=Object(c.useContext)(O.a).state,s=Object(c.useState)(!1),n=Object(o.a)(s,2),d=n[0],i=n[1],j=Object(c.useState)(!1),u=Object(o.a)(j,2),l=u[0],b=u[1];return t.user.username?Object(g.jsx)(e,{}):Object(g.jsxs)("div",{className:"justify-content-end",children:[Object(g.jsx)(f.a,{variant:"secondary",onClick:function(e){return i(!0)},children:"Login"})," "," ",Object(g.jsx)(v,{show:d,handleClose:function(){return i(!1)}}),Object(g.jsx)(f.a,{variant:"secondary",onClick:function(e){return b(!0)},children:"Register"}),Object(g.jsx)(C,{show:l,handleClose:function(){return b(!1)}})]})}var y=a(107),E=function(e){var t=e.text;return Object(g.jsx)(p.a,{href:"/",children:Object(g.jsx)(y.a.Brand,{style:{color:"darkslateblue"},children:t})})},T=a(104),k=a(105);function _(){return Object(g.jsx)(y.a,{bg:"light",expand:"lg",children:Object(g.jsxs)(T.a,{children:[Object(g.jsx)(y.a.Brand,{href:"/",children:Object(g.jsx)(E,{text:"My Todo List - Homepage"})}),Object(g.jsx)(y.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(g.jsxs)(y.a.Collapse,{id:"basic-navbar-nav",children:[Object(g.jsx)(k.a,{className:"me-auto",children:Object(g.jsx)(k.a.Link,{children:Object(g.jsx)(p.a,{href:"/users",children:"Access Users Page"})})}),Object(g.jsx)(r.a.Suspense,{fallback:"Loading...",children:Object(g.jsx)(w,{})})]})]})})}var S=a(109);function L(e){var t=e.title,a=e.description,r=e.dateCreated,s=e.completed,n=e.dateCompleted,d=e._id,i=e.author,j=Object(c.useContext)(O.a),u=j.state,l=j.dispatch,b=u.user,x=Object(h.b)((function(e){return{url:"/todo/".concat(e),method:"delete",headers:{Authorization:"".concat(u.user.access_token)},data:{username:b.username,author:i}}})),m=Object(o.a)(x,2),v=m[0],C=m[1],w=Object(h.b)((function(e,t){return{url:"/todo/".concat(e),method:"patch",headers:{Authorization:"".concat(u.user.access_token)},data:{completed:t,dateCompleted:Date(Date.now()).toString(),username:b.username,author:i}}})),y=Object(o.a)(w,2),E=y[0],T=y[1];return Object(c.useEffect)((function(){if(v&&v.data&&!1===v.isLoading){var e=v.data._id;l({type:"DELETE_TODO",id:e})}}),[v]),Object(c.useEffect)((function(){E&&(E.data||E.error)&&!1===E.isLoading&&(E.error?console.log("GOT AN ERROR BACK FROM TOGGLE TODO"):(console.log(E.data.completed),console.log(E.data.dateCompleted),l({type:"TOGGLE_TODO",completed:E.data.completed,dateCompleted:E.data.dateCompleted,id:d})))}),[E]),Object(g.jsx)(S.a,{children:Object(g.jsxs)(S.a.Body,{children:[Object(g.jsx)(S.a.Title,{children:t}),Object(g.jsx)(S.a.Subtitle,{children:Object(g.jsxs)("i",{children:["Written by ",Object(g.jsx)("b",{children:i})]})}),Object(g.jsxs)(S.a.Text,{children:[Object(g.jsx)("div",{children:a}),Object(g.jsxs)("div",{children:["Todo ID: ",d]}),Object(g.jsxs)("div",{children:[" Date created: ",r," "]}),Object(g.jsxs)("div",{children:[" ",s&&Object(g.jsxs)("text",{children:[" Date completed: ",n," "]})]}),Object(g.jsxs)("label",{children:[" Completed? ",Object(g.jsx)("b",{}),Object(g.jsx)("input",{type:"checkbox",checked:s,onChange:function(e){T(d,e.target.checked)}})]})]}),Object(g.jsx)(f.a,{variant:"primary",onClick:function(e){C(d)},children:"Delete Todo"}),Object(g.jsx)("p",{}),Object(g.jsxs)(p.a,{href:"/users/".concat(i),children:["View ",i,"'s page"]})]})})}function D(){var e=Object(c.useContext)(O.a).state.todos;return Object(g.jsx)("div",{children:e.map((function(e,t){return Object(c.createElement)(L,Object(d.a)(Object(d.a)({},e),{},{title:e.title,author:e.author,description:e.description,dateCreated:e.dateCreated,completed:e.completed,dateCompleted:e.dateCompleted,key:"post-"+t,_id:e._id}))}))})}function R(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(c.useState)(""),n=Object(o.a)(s,2),d=n[0],i=n[1],j=Object(c.useState)(!1),u=Object(o.a)(j,2),l=u[0],b=u[1],p=Object(c.useState)(""),x=Object(o.a)(p,2),m=x[0],f=x[1];var v=Object(h.b)((function(e){var t=e.title,a=e.description,c=e.dateCreated,r=e.completed,s=e.dateCompleted,n=e.author;return{url:"/todo",method:"post",headers:{Authorization:"".concat(T.user.access_token)},data:{title:t,description:a,dateCreated:c,completed:r,dateCompleted:s,author:n}}})),C=Object(o.a)(v,2),w=C[0],y=C[1],E=Object(c.useContext)(O.a),T=E.state,k=E.dispatch,_=T.user;return Object(c.useEffect)((function(){w&&!1===w.isLoading&&w.data&&(console.log(w.data.id),k({type:"CREATE_TODO",title:w.data.title,description:w.data.description,dateCreated:w.data.dateCreated,completed:w.data.completed,dateCompleted:w.data.dateCompleted,_id:w.data.id,author:_.username}))}),[w]),Object(g.jsxs)("form",{onSubmit:function(e){e.preventDefault(),y({title:a,description:d,dateCreated:Date(Date.now()).toString(),completed:l,dateCompleted:m,author:_.username})},children:[Object(g.jsxs)("div",{children:["Author: ",Object(g.jsx)("b",{children:_.username})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"create-title",children:"Todo Item Title: "})," ",Object(g.jsx)("b",{}),Object(g.jsx)("input",{type:"text",value:a,onChange:function(e){r(e.target.value)},name:"create-title",id:"create-title",required:!0})]}),Object(g.jsx)("textarea",{value:d,onChange:function(e){i(e.target.value)}}),Object(g.jsx)("input",{type:"submit",value:"Create"}),Object(g.jsx)("div",{children:Object(g.jsxs)("label",{children:[" Already Completed? Click Here! ",Object(g.jsx)("b",{}),Object(g.jsx)("input",{type:"checkbox",name:"box-id",value:l,checked:l,onClick:function(e){b(!l),f(!0===l?"":Date(Date.now()).toString())}})]})})]})}function F(){var e=Object(c.useContext)(O.a),t=e.state,a=e.dispatch,r=Object(h.b)((function(){return{url:"/todo",method:"get",headers:{Authorization:"".concat(t.user.access_token)}}})),s=Object(o.a)(r,2),n=s[0],d=s[1];Object(c.useEffect)((function(){d()}),[t.user.access_token]),Object(c.useEffect)((function(){n&&!1===n.isLoading&&n.data&&a({type:"FETCH_TODOS",todos:n.data.todos.reverse()})}),[n]);n.data;var i=n.isLoading;return Object(g.jsxs)(g.Fragment,{children:[t.user.username&&Object(g.jsx)(R,{})," ",Object(g.jsx)("br",{}),i&&"Todos loading..."," ",Object(g.jsx)(D,{})]})}function A(e){var t=e.author,a=Object(c.useContext)(O.a),r=a.state,s=a.dispatch,n=r.user,d=Object(h.b)((function(){return{url:"/todo/".concat(t),headers:{Authorization:"".concat(r.user.access_token)},method:"get"}})),i=Object(o.a)(d,2),j=i[0],u=i[1];Object(c.useEffect)(u,[t]),Object(c.useEffect)((function(){j&&j.data&&s({type:"FETCH_TODOS",todos:j.data.todos.reverse()})}),[j]);j.data;var l=j.isLoading;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("h1",{children:[" ",t,"'s Todo Page "]}),function(e){return e===t}(n.username)&&Object(g.jsx)(R,{})," ",Object(g.jsx)("br",{}),l&&"Todos loading..."," ",Object(g.jsx)(D,{}),Object(g.jsx)("br",{}),Object(g.jsx)("div",{children:Object(g.jsx)(p.a,{href:"/",children:"Go back to homepage"})})]})}function G(e){var t=e.username;return Object(g.jsxs)("div",{children:[Object(g.jsxs)(p.a,{href:"".concat(t),children:[" ",t," "]}),Object(g.jsx)("br",{})]})}function H(){var e=Object(c.useContext)(O.a).state.users;return Object(g.jsx)("div",{children:e.map((function(e,t){return Object(c.createElement)(G,Object(d.a)(Object(d.a)({},e),{},{username:e.username,key:"user-"+t}))}))})}function I(){var e=Object(c.useContext)(O.a),t=e.state,a=e.dispatch,r=Object(h.b)((function(){return{url:"/auth",headers:{Authorization:"".concat(t.user.access_token)},method:"get"}})),s=Object(o.a)(r,2),n=s[0],d=s[1];Object(c.useEffect)(d,[]),Object(c.useEffect)((function(){n&&n.data&&!1===n.isLoading&&(console.log("SENDING A FETCH USER DISPATCH"),a({type:"FETCH_USERS",users:n.data.users}))}),[n]);n.data;var i=n.isLoading;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h1",{children:" User List "}),i&&"Users loading..."," ",Object(g.jsx)(H,{})," ",Object(g.jsx)("br",{}),Object(g.jsx)("div",{children:Object(g.jsx)(p.a,{href:"/",children:"Go back to homepage"})})]})}var U=a(12);var B=function(){var e=Object(c.useReducer)(b,{user:{},users:[],todos:[]}),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(U.f)({"/":Object(U.g)({view:Object(g.jsx)(F,{})}),"/users":Object(U.g)({view:Object(g.jsx)(I,{})}),"/users/:author":Object(U.g)((function(e){return{view:Object(g.jsx)(A,{author:e.params.author})}}))});return Object(g.jsx)("div",{children:Object(g.jsx)(O.a.Provider,{value:{state:a,dispatch:r},children:Object(g.jsx)(p.b,{routes:s,children:Object(g.jsxs)(T.a,{children:[Object(g.jsx)(_,{}),Object(g.jsx)("hr",{}),Object(g.jsx)(p.c,{})]})})})})},z=a(37),N=a.n(z).a.create({baseURL:"/"});n.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(h.a,{value:N,children:Object(g.jsx)(B,{})})}),document.getElementById("root"))},9:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var c=a(0),r=a.n(c).a.createContext({state:{},dispatch:function(){}})}},[[100,1,2]]]);
//# sourceMappingURL=main.0a5ecb85.chunk.js.map